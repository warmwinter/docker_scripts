# postgres Version 9.6.x

# https://hub.docker.com/_/postgres?tab=description&page=1&name=9-a

FROM postgres:9-alpine3.14

LABEL Description="postgres v9.6.x Docker" Vendor="Demo Studio" Version="1.0.0"

# Some Enviroment
ENV ALPINE_VERSION 3.14

RUN set -xe \
# Change alpine mirror to demostic
    && mv /etc/apk/repositories /etc/apk/repositories.bak \
    && echo "https://mirrors.aliyun.com/alpine/v${ALPINE_VERSION}/main" > /etc/apk/repositories \
    && echo "https://mirrors.aliyun.com/alpine/v${ALPINE_VERSION}/community" >> /etc/apk/repositories \
#
# Modify resolve.conf, use AliDNS (www.alidns.com)
    && echo '# Generated by NetworkManager' > /etc/resolv.conf \
    && echo 'nameserver 223.5.5.5' >> /etc/resolv.conf \
    && echo 'nameserver 223.6.6.6' >> /etc/resolv.conf \
#
# Config the System, inclue timezone
    && apk add --no-cache --virtual .system-deps tzdata \
    && cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \
    && echo 'Asia/Shanghai' > /etc/timezone \
    && date \
    && apk del .system-deps

STOPSIGNAL SIGINT
EXPOSE 5432
CMD ["postgres"]
